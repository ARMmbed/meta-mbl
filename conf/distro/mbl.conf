###############################################################################
# mbed Linux 
# Copyright (c) 2017 ARM Limited
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
###############################################################################

###############################################################################
# mbl.conf
#   This file is the mbed linux OpenEmbedded distribution configuration file.
###############################################################################

DISTRO_NAME = "Mbed Linux IoT Distribution"
DISTRO_VERSION = "0.1"
DISTRO_FEATURES_append = " virtualization"

# Enable build history with installed package size information and image info. 
INHERIT += "buildhistory"
INHERIT += "image-buildinfo"
BUILDHISTORY_COMMIT = "1"

KERNEL_IMAGETYPE_raspberrypi3 = "uImage"
RPI_USE_U_BOOT = "1"

IMAGE_FSTYPES = "wic.gz wic.bmap tar.xz"

WKS_FILE_raspberrypi3 = "mbl-raspberrypi3.wks"

WKS_FILE_imx7s-warp = "mbl-imx7s-warp.wks"
WKS_FILE_imx7s-warp-mbl = "mbl-imx7s-warp.wks"

IMAGE_BOOT_FILES += "boot.scr"
IMAGE_BOOT_FILES_append_imx7s-warp-mbl = " u-boot.bin"
IMAGE_BOOT_FILES_append_imx7s-warp-mbl = " u-boot.cfgout"
IMAGE_BOOT_FILES_append_imx7s-warp-mbl = " u-boot.cfg"

# Remove x11 related packages for distro images.
DISTRO_FEATURES_DEFAULT_remove = "x11"

# Path to where the "config" partition is mounted (see docs/partitions.md).
#
# If this is changed the .wks files in the wic directory will also need
# changing.
MBL_CONFIG_DIR = "/config"

# Tell the meta-raspberrypi layer to send Linux console output to the serial
# console
ENABLE_UART_raspberrypi3 = "1"

# meta-mbl's linux-firmware bbappend (for imx7s-warp-mbl support) conflicts
# with meta-raspberrypi's linux-firmware bbappend (for rpi support). Make sure
# meta-raspberrypi's bbappend doesn't get used for imx7s-warp-mbl and
# meta-mbl's bbappend doesn't get used for raspberrypi
BBMASK_append_rpi = " /meta-mbl/recipes-kernel/linux-firmware/"
BBMASK_append_imx7s-warp-mbl = " /meta-raspberrypi/recipes-kernel/linux-firmware/"
