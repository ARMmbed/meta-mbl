#@TYPE: Machine
#@NAME: bananapi-zero
#@DESCRIPTION: Machine configuration for the bananapi-zero, base on allwinner H2+ CPU

MACHINEOVERRIDES =. "bananapi:bananapi-zero:${MACHINE}:"

require conf/machine/include/sun8i.inc

PREFERRED_PROVIDER_virtual/kernel="linux-mainline"
PREFERRED_VERSION_linux = "linux-bpi"
PREFERRED_PROVIDER_u-boot = "u-boot-bpi"
PREFERRED_PROVIDER_virtual/bootloader = "u-boot-bpi"


KERNEL_DEVICETREE = "sun8i-h2-plus-bananapi-m2-zero.dtb"
KERNEL_IMAGETYPE_bananapi-zero = "zImage"

UBOOT_MACHINE = "bananapi_zero_defconfig"

SPL_BINARY="spl/sunxi-spl.bin"

DEFAULTTUNE = "cortexa7hf-neon-vfpv4"

IMAGE_CLASSES_remove = "sdcard_image-sunxi"

WKS_FILE_bananapi-zero = "mbl-bananapi-zero.wks"

IMAGE_BOOT_FILES_append_bananapi-zero = " kernel.itb"

# backup files for adding signature outside yocoto in future
IMAGE_BOOT_FILES_append_bananapi-zero += " kernel.its"
IMAGE_BOOT_FILES_append_bananapi-zero += " u-boot.its u-boot-nodtb.bin u-boot.dtb boot.its boot.cmd sunxi-spl.bin"

MACHINE_EXTRA_RRECOMMENDS += " linux-firmware-bcm43430 linux-firmware-cyw43430a1 "
MACHINE_FEATURES += " wifi bluetooth"
